//
// Property PROP_SPH Type34

ATTRIBUTES(COMMON)
{
    MASS                                    = VALUE(FLOAT,  " Mass of the Particles");
    qa                                      = VALUE(FLOAT,  " Quadratic Bulk Viscosity");
    qb                                      = VALUE(FLOAT,  " Linear Bulk Viscosity");
    ALPHA1                                  = VALUE(FLOAT,  " Conservative Smoothing Coefficient");
    ORDER                                   = VALUE(INT,  " SPH Correction Order");
    h                                       = VALUE(FLOAT,  " Smoothing Length");
    
    //Atrributes for HM usage
    KEYWORD_STR                             = VALUE(STRING, "Solver Keyword");
    NUM_COMMENTS                            = SIZE("NUM_COMMENTS");
    COMMENTS                                = ARRAY[NUM_COMMENTS](STRING,  "Entity_Comments");
    CommentEnumField                        = VALUE(INT,  "User Comments");
    Prop_Name_OR_Type                       = VALUE(INT, "");
    TITLE                                   = VALUE(STRING, "");
    IO_FLAG                                 = VALUE(INT, "");
    TYPE_NO                                 = VALUE(STRING, "");
}

SKEYWORDS_IDENTIFIER(COMMON)
{
    KEYWORD_STR                             = 9000;
    NUM_COMMENTS                            = 5110;
    COMMENTS                                = 5109;
    CommentEnumField                        = 7951;
    ALPHA1                                  = 6145;
    MASS                                    =  167;
    ORDER                                   = 4335;
    h                                       = 8031;
    qa                                      = 8029;
    qb                                      = 8030;
    Prop_Name_OR_Type                       = 4537;
    TITLE                                   =   -1;
    IO_FLAG                                 =   -1;
    TYPE_NO                                 =   -1;
}

DEFAULTS(COMMON)
{
    ORDER                                   =   0;
    qa                                      = 2.0;
    qb                                      = 1.0;
    Prop_Name_OR_Type                       = 0;
}

GUI(COMMON)
{
    RADIO(CommentEnumField)
    {
       ENUM_VALUE_FLAG=TRUE;
       ADD(1, "1:Hide in Menu/Export");
       ADD(2, "2:Show in Menu/Export");
       ADD(3, "3:Do Not Export");
    }
    if(CommentEnumField == 2)
    {  
        SIZE(NUM_COMMENTS);
        ARRAY(NUM_COMMENTS,"")
        {
            SCALAR(COMMENTS);
        }   
    }
    if( Prop_Name_OR_Type == 2)
    {
        ASSIGN(KEYWORD_STR, "/PROP");
        ASSIGN(KEYWORD_STR, "/TYPE34/");
    }
    else
    {
        ASSIGN(KEYWORD_STR, "/PROP");
        ASSIGN(KEYWORD_STR, "/SPH/");
    }
    SCALAR(MASS) { DIMENSION="m"; }
    SCALAR(qa);
    SCALAR(qb);
    SCALAR(ALPHA1);
    RADIO(ORDER)
    {
        ADD(-1, "-1:Means No Correction at All.");
        ADD(0, "0:Means Order 0 Correction.");
        ADD(1, "1:Means Correction Up to Order 1 - Not Allowed for SPMD Parallel Version.");
    }
    SCALAR(h) { DIMENSION="l"; }
}

// File format for Radioss 51
FORMAT(radioss51) 
{
    ASSIGN(IO_FLAG, 0, EXPORT);
    ASSIGN(IO_FLAG, 1,IMPORT);
    if(IO_FLAG == 1)
    {
        HEADER("/PROP/%4s",TYPE_NO);
        if(TYPE_NO == "TYPE" )
        {
            ASSIGN(Prop_Name_OR_Type,2);
        }
    }
    else if(IO_FLAG == 0 && Prop_Name_OR_Type == 2)
    {
        HEADER("/PROP/TYPE34/%d",_ID_);
    }
    else
    {
        HEADER("/PROP/SPH/%d",_ID_);
    }
    CARD("%-100s", TITLE);
    COMMENT("#                 Mp                  qa                  qb            Alpha_CS");
    CARD("%20lg%20lg%20lg%20lg",MASS,qa,qb,ALPHA1);
    //
    COMMENT("#    Order                   h");
    CARD("%10d%20lg",ORDER,h);
}
FORMAT(radioss44) 
{
    ASSIGN(IO_FLAG, 0, EXPORT);
    ASSIGN(IO_FLAG, 1,IMPORT);
    if(IO_FLAG == 1)
    {
        HEADER("/PROP/%4s/%d/%s",TYPE_NO,_ID_,TITLE);
        if(TYPE_NO == "TYPE" )
        {
            ASSIGN(Prop_Name_OR_Type,2);
        }
    }
    COMMENT("#             Mp              Qa              Qb        Alpha_CS");
    CARD("%16lg%16lg%16lg%16lg",MASS,qa,qb,ALPHA1);
    COMMENT("#  order               h");
    CARD("%8d%16lg",ORDER,h);
}