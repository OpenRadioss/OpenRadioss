//Copyright>    CFG Files and Library ("CFG")
//Copyright>    Copyright (C) 1986-2025 Altair Engineering Inc.
//Copyright>
//Copyright>    Altair Engineering Inc. grants to third parties limited permission to
//Copyright>    use and modify CFG solely in connection with OpenRadioss software, provided
//Copyright>    that any modification to CFG by a third party must be provided back to
//Copyright>    Altair Engineering Inc. and shall be deemed a Contribution under and therefore
//Copyright>    subject to the CONTRIBUTOR LICENSE AGREEMENT for OpenRadioss software.
//Copyright>
//Copyright>    CFG IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,
//Copyright>    INCLUDING, BUT NOT LIMITED TO, THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR
//Copyright>    A PARTICULAR PURPOSE, AND NONINFRINGEMENT.  IN NO EVENT SHALL ALTAIR ENGINEERING
//Copyright>    INC. OR ITS AFFILIATES BE LIABLE FOR ANY CLAIM, DAMAGES, OR OTHER LIABILITY,
//Copyright>    WHETHER IN AN ACTION OF CONTRACT, TORT, OR OTHERWISE, ARISING FROM, OUT OF, OR
//Copyright>    IN CONNECTION WITH CFG OR THE USE OR OTHER DEALINGS IN CFG.
// Material law87
ATTRIBUTES(COMMON)
{
    KEYWORD_STR                = VALUE(STRING, "Solver Keyword");
    NUM_COMMENTS               = SIZE("NUM_COMMENTS");
    COMMENTS                   = ARRAY[NUM_COMMENTS](STRING,  "Entity_Comments");
    CommentEnumField           = VALUE(INT,  "User Comments");
    MAT_RHO                    = VALUE(FLOAT,  "Initial Density");
    MAT_REFRHO_Option          = VALUE(INT,  "RefRho_Option");
    Refer_Rho                  = VALUE(FLOAT,  "Ref_Rho");
    DUMMY                      = VALUE(STRING,"Dummy variable for Ref_Rho flag");
    MAT_E                      = VALUE(FLOAT,  "Young's Modulus");
    MAT_NU                     = VALUE(FLOAT,  "Poisson's Ratio");
    MAT_Iflag                  = VALUE(INT,  "Yield Stress Definition Flag");
    Vflag                      = VALUE(INT,  "Strain Rate Choice Flag");
    STRAIN1                    = VALUE(FLOAT,  "Cowper Seymonds Reference Strain Rate");
    MAT_EXP1                   = VALUE(FLOAT,  "Cowper Seymonds strain rate exponent");
    Ifit                       = VALUE(INT,"Material parameter fit flag");
    MAT_ALPHA1                 = VALUE(FLOAT,  "Alpha1");
    MAT_ALPHA2                 = VALUE(FLOAT,  "Alpha2");
    MAT_ALPHA3                 = VALUE(FLOAT,  "Alpha3");
    MAT_ALPHA4                 = VALUE(FLOAT,  "Alpha4");
    MAT_ALPHA5                 = VALUE(FLOAT,  "Alpha5");
    MAT_ALPHA6                 = VALUE(FLOAT,  "Alpha6");
    MAT_ALPHA7                 = VALUE(FLOAT,  "Alpha7");
    MAT_ALPHA8                 = VALUE(FLOAT,  "Alpha8");
    Sigma_00                   = VALUE(FLOAT,"Yield strength in 00 direction");
    Sigma_45                   = VALUE(FLOAT,"Yield strength in 45 direction");                                
    Sigma_90                   = VALUE(FLOAT,"Yield strength in 90 direction");
    Sigma_b                    = VALUE(FLOAT,"Yield strength biaxial loading");
    r_00                       = VALUE(FLOAT,"Lankford r-value in 00 direction");
    r_45                       = VALUE(FLOAT,"Lankford r-value in 45 direction");
    r_90                       = VALUE(FLOAT,"Lankford r-value in 90 direction");
    r_b                        = VALUE(FLOAT,"Lankford r-value in biaxial loading");
    A                          = VALUE(FLOAT,"a, Exponent in Yield Function");
    MAT_VOL                    = VALUE(FLOAT,  "Yield Weighting Coefficient");
    FScale33                   = VALUE(FLOAT,  "n,Swift Hardening Exponent");
    Fcut                       = VALUE(FLOAT,  "Cutoff Frequency for Strain Rate Filtering");
    MAT_FSMOOTH                = VALUE(INT,  "Smooth Strain Rate Option Flag");
    MAT_ISMOOTH                = VALUE(INT,  "Strain Rate interpolation flag");
    MAT_NRATE                  = SIZE("Number of Yield Functions");
    MAT_A                      = VALUE(FLOAT,  "Swift Hardening Coefficient");
    FScale22                   = VALUE(FLOAT,  "Swift Hardening Parameter");
    MAT_PR                     = VALUE(FLOAT,  "Hardening Coefficient");
    MAT_T0                     = VALUE(FLOAT,  "Voce Plastic Strain Coefficient");
    MAT_NUt                    = VALUE(FLOAT,  "Voce Hardening Parameter");
    FUN_LOAD                   = ARRAY[MAT_NRATE](FUNCT,  "Yield Stress Vs Plastic Strain Function");
    SCALE_LOAD                 = ARRAY[MAT_NRATE](FLOAT,  "Fscalei,Scale Factor for Fct_IDi Ordinate");
    STRAINRATE_LOAD            = ARRAY[MAT_NRATE](FLOAT,  "Epspi,Strain Rate for Fct_IDi");
//
      MAT_kin     = VALUE(FLOAT,  "Kinematic hardening Flag");
      MAT_K1      = VALUE(FLOAT,  "Parameter K1 for temperature dependency in Hansel hardening law");
      MAT_K2      = VALUE(FLOAT,  "Parameter K2 for temperature dependency in Hansel hardening law");
      MAT_AHS     = VALUE(FLOAT,  "Parameter Ahs  in Hansel hardening law");
      MAT_BHS     = VALUE(FLOAT,  "Parameter Bhs  in Hansel hardening law");
      MAT_MHS     = VALUE(FLOAT,  "Parameter Mhs  in Hansel hardening law");
      MAT_EPS0HS  = VALUE(FLOAT,  "Parameter Eps0hs  in Hansel hardening law");
      MAT_NHS     = VALUE(FLOAT,  "Parameter Nhs  in Hansel hardening law");
      MAT_HMART   = VALUE(FLOAT,  "Parameter Hmart  in Hansel hardening law");
      MAT_TEMP0   = VALUE(FLOAT,  "Initial temperature");
      MAT_TREF    = VALUE(FLOAT,  "Reference temperature");
      MAT_ETA     = VALUE(FLOAT,  "Taylor-Quiney coefficient");
      MAT_CP      = VALUE(FLOAT,  "specific heat for temperature calculation");
      MAT_AM      = VALUE(FLOAT,  "Parameter AM for martensite rate equation");
      MAT_BM      = VALUE(FLOAT,  "Parameter BM for martensite rate equation");
      MAT_CM      = VALUE(FLOAT,  "Parameter CM for martensite rate equation"); 
      MAT_DM      = VALUE(FLOAT,  "Parameter DM for martensite rate equation");
      MAT_PM      = VALUE(FLOAT,  "Parameter PM for martensite rate equation");
      MAT_QM      = VALUE(FLOAT,  "Parameter QM for martensite rate equation");
      MAT_E0MART  = VALUE(FLOAT,  "Parameter E0MART for martensite rate equation"); 
      MAT_VM0     = VALUE(FLOAT,  "Initial volume fraction VM0 for martensite rate equation");
//
      MAT_CRC1    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter C1 ");
      MAT_CRA1    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter a1");
      MAT_CRC2    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter C2");
      MAT_CRA2    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter a2");
      MAT_CRC3    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter C3 ");
      MAT_CRA3    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter a3");
      MAT_CRC4    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter C4");
      MAT_CRA4    = VALUE(FLOAT,  "Chaboche_rousselier kinematic parameter a4");
//
      TAB_ID0     = VALUE(TABLE,  "Tabulated yield stress in direction 0°");
      TAB_ID45    = VALUE(TABLE,  "Tabulated yield stress in direction 45°");
      TAB_ID90    = VALUE(TABLE,  "Tabulated yield stress in direction 90°");
      FSCALE0     = VALUE(FLOAT,  "Scale factor for tabulated yield stress in direction 0°");
      FSCALE45    = VALUE(FLOAT,  "Scale factor for tabulated yield stress in direction 45°");
      FSCALE90    = VALUE(FLOAT,  "Scale factor for tabulated yield stress in direction 90°");
      EPSD0       = VALUE(FLOAT,  "Reference strain rate for tabulated yield stress in direction 0°");
      EPSD45      = VALUE(FLOAT,  "Reference strain rate for tabulated yield stress in direction 45°");
      EPSD90      = VALUE(FLOAT,  "Reference strain rate for tabulated yield stress in direction 90°");
//
    IO_FLAG                    = VALUE(INT, "");
    LAW_NO                     = VALUE(STRING, "");
    Mat_Name_OR_LawNo          = VALUE(INT,  "RADIOSS_COMMENT_FLAG");
    TITLE                      = VALUE(STRING,"");
    Heat_Inp_opt               = VALUE(INT,   "Heat");  
    SUBGRP_HEAT_MAT            = VALUE(SUBOBJECT, "");
    THERM_STRESS               = VALUE(INT,"Therm Stress");
    SUBGRP_THERM_STRESS        = VALUE(SUBOBJECT, "");
}

SKEYWORDS_IDENTIFIER(COMMON)
{
    KEYWORD_STR                = 9000;
    COMMENTS                   = 5109;
    CommentEnumField           = 7951;
    NUM_COMMENTS               = 5110;
    MAT_RHO                    = 118;
    MAT_REFRHO_Option          = 4285;
    Refer_Rho                  = 4229;
    DUMMY                      = -1;
    MAT_E                      = 119;
    MAT_NU                     = 120;
    MAT_Iflag                  = 6002;
    Vflag                      = 5113;
    STRAIN1                    = 4914;
    MAT_EXP1                   = 5099;
    Ifit                       = 2702;
    MAT_ALPHA1                 = 375;
    MAT_ALPHA2                 = 377;
    MAT_ALPHA3                 = 381;
    MAT_ALPHA4                 = 382;
    MAT_ALPHA5                 = 386;
    MAT_ALPHA6                 = 5084;
    MAT_ALPHA7                 = 5085;
    MAT_ALPHA8                 = 5086;
    Sigma_00                   = 2703;
    Sigma_45                   = 2704;
    Sigma_90                   = 2705;
    Sigma_b                    = 2706;
    r_00                       = 2707;
    r_45                       = 2708;
    r_90                       = 2709;
    r_b                        = 2710;
    A                          = 2986;
    MAT_VOL                    = 4276;
    FScale33                   = 4052;
    Fcut                       = 5356;
    MAT_FSMOOTH                = 1051;
    MAT_ISMOOTH                = -1;
    MAT_NRATE                  = 1052;
    MAT_A                      = 6056;
    FScale22                   = 4051;
    MAT_PR                     = 5096;
    MAT_T0                     = 6133;
    MAT_NUt                    = 5083;
    FUN_LOAD                   = 4234;
    SCALE_LOAD                 = 4236;
    STRAINRATE_LOAD            = 4235;
    FSCALE0                    = -1;
    FSCALE45                   = -1;
    FSCALE90                   = -1;
    EPSD0                      = -1;
    EPSD45                     = -1;
    EPSD90                     = -1;
    LAW_NO                     = -1;
    Mat_Name_OR_LawNo          = 4538;
    IO_FLAG                    = -1;
    TITLE                      = -1;
    Heat_Inp_opt               = 4346;
    SUBGRP_HEAT_MAT            = -1;
    THERM_STRESS               = 4555;
    SUBGRP_THERM_STRESS        = -1;
}

DRAWABLES(COMMON) {
public:
    INITIAL_DENSITY                 = SCALAR(MAT_RHO);
    YOUNG_MODULUS                   = SCALAR(MAT_E);
    POISSON_RATIO                   = SCALAR(MAT_NU);
public:
    SOUND_SPEED                     = EVAL((YOUNG_MODULUS/INITIAL_DENSITY)^0.5);
private:
    G                               = EVAL(YOUNG_MODULUS/(2*(1+POISSON_RATIO)));
    C1                              = EVAL(YOUNG_MODULUS/(3*(1-2*POISSON_RATIO)));
public:
    SOUND_SPEED_SOLID               = EVAL(((4*G/3+C1)/INITIAL_DENSITY)^0.5);
}

CHECK(COMMON)
{
    MAT_RHO                     >0.0;
}

DEFAULTS(COMMON)
{
    FScale22                    = 0.0;
    FScale33                    = 1;
    Fcut                        = 1.0e30;
    MAT_FSMOOTH                 = 0;
    MAT_ISMOOTH                 = 1;
    MAT_Iflag                   = 0;
    MAT_T0                      = 0.0;
    MAT_VOL                     = 0;
    Vflag                       = 0;
    Mat_Name_OR_LawNo           = 0;
}

GUI(COMMON)
{
    RADIO(CommentEnumField)
    {
        ENUM_VALUE_FLAG=TRUE;
        ADD(1, "Hide in Menu/Export");
        ADD(2, "Show in Menu/Export");
        ADD(3, "Do Not Export");
    }
    if( CommentEnumField == 2)
    {
        SIZE(NUM_COMMENTS);
        ARRAY(NUM_COMMENTS,"")
        {
            SCALAR(COMMENTS);
        }
    }
    if( Mat_Name_OR_LawNo == 1)
    {
        ASSIGN(KEYWORD_STR, "/MAT");
        ASSIGN(KEYWORD_STR, "/BARLAT2000/");
    }
    else
    {
        ASSIGN(KEYWORD_STR, "/MAT");
        ASSIGN(KEYWORD_STR, "/LAW87/");
    }
mandatory:
    SCALAR(MAT_RHO)                                { DIMENSION="density";}
optional:
    graphical FLAG( MAT_REFRHO_Option);
    if(MAT_REFRHO_Option!=FALSE)
    {
        SCALAR(Refer_Rho);
    }
mandatory:
    SCALAR(MAT_E)                                   { DIMENSION="pressure";}
    SCALAR(MAT_NU)                                  { DIMENSION = "DIMENSIONLESS"; }
    
    RADIO(MAT_Iflag)
    {
        ADD(0, "Tabulated Input (default)");
        ADD(1, "Swift-Voce Analytic Formulation");
    }

    RADIO(Vflag)
    {
        ADD(0, "0: Strain Rate Effect on Yield Stress Depends on the Total Strain Rate (Default)");
        ADD(1, "1: Strain Rate Effect on Yield Depends on the Plastic Strain Rate");
    }
    SCALAR(STRAIN1)                              { DIMENSION="strain_rate";   }
    SCALAR(MAT_EXP1)                             { DIMENSION = "DIMENSIONLESS"; }
optional:
    RADIO(Ifit)
    {
        ADD(0, "0: Barlat parameters in Alpha1 through Alpha8");
        ADD(1, "1: Barlat parameters are calculated from the test data");
    }
    
    if( Ifit == 0)
    {
        SCALAR(MAT_ALPHA1)                              { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(MAT_ALPHA2)                              { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(MAT_ALPHA3)                              { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(MAT_ALPHA4)                              { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(MAT_ALPHA5)                              { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(MAT_ALPHA6)                              { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(MAT_ALPHA7)                              { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(MAT_ALPHA8)                              { DIMENSION = "DIMENSIONLESS"; }
    }
    else if( Ifit == 1)
    {
        SCALAR(Sigma_00)                            { DIMENSION="pressure"; }
        SCALAR(Sigma_45)                            { DIMENSION="pressure"; }           
        SCALAR(Sigma_90)                            { DIMENSION="pressure"; }
        SCALAR(Sigma_b)                             { DIMENSION="pressure"; }
        SCALAR(r_00)                                { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(r_45)                                { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(r_90)                                { DIMENSION = "DIMENSIONLESS"; }
        SCALAR(r_b)                                 { DIMENSION = "DIMENSIONLESS"; }
    }

    SCALAR(A)                                       { DIMENSION = "DIMENSIONLESS"; }
    SCALAR(MAT_VOL)                                 { DIMENSION = "DIMENSIONLESS"; }
    SCALAR(FScale33)                                { DIMENSION = "DIMENSIONLESS"; }
    SCALAR(Fcut)                                    { DIMENSION ="f";	   }

    RADIO(MAT_FSMOOTH)
    {
        ADD(0, "0: No Strain Rate Smoothing (default)");
        ADD(1, "1: Strain Rate Smoothing active");
    }

    RADIO(MAT_ISMOOTH)
    {
        ADD(1, "1: Linear interpolation (default)");
        ADD(2, "2: Logarithmic base 10 interpolation");
        ADD(3, "2: Logarithmic base n interpolation");
    }

    if( MAT_Iflag == 0)
    {
        SIZE(MAT_NRATE);    
    }
    if( MAT_Iflag == 0 && MAT_NRATE > 0)
    {
        ARRAY(MAT_NRATE,"Strain rate") 
        {
            //mandatory:
            //DATA(FUN_LOAD);
            /*FUNCTION(FUN_LOAD) {
                X_TITLE     = "Plastic Strain"; Y_TITLE     = "Yield stress"; 
                X_DIMENSION = "DIMENSIONLESS"; Y_DIMENSION="pressure";
                // Y_SCALING(SCALE_LOAD);
            }*/
            SCALAR(SCALE_LOAD)      { DIMENSION="pressure"; }
            SCALAR(STRAINRATE_LOAD){ DIMENSION="strain_rate"; }
        }
    }


    SCALAR(MAT_A)                              { DIMENSION="pressure"; }
    SCALAR(FScale22)                           { DIMENSION="DIMENSIONLESS";}
    SCALAR(MAT_PR)                             { DIMENSION="pressure"; }
    SCALAR(MAT_T0)                             { DIMENSION="DIMENSIONLESS";}
    SCALAR(MAT_NUt)                            { DIMENSION="pressure"; }
    if( MAT_Iflag == 2)
    {
        SCALAR(MAT_AHS)                              { DIMENSION="pressure"; }
        SCALAR(MAT_BHS)                              { DIMENSION="pressure"; }
        SCALAR(MAT_HMART)                            { DIMENSION="pressure"; }
        SCALAR(MAT_CP)                               { DIMENSION="thermal_massic_capacity";}     

    }

    if( MAT_Iflag == 3)
    {
        SCALAR(FSCALE0)                              { DIMENSION="pressure"; }
        SCALAR(FSCALE45)                             { DIMENSION="pressure"; }
        SCALAR(FSCALE90)                             { DIMENSION="pressure"; }
        SCALAR(EPSD0)                                { DIMENSION="f";}     
        SCALAR(EPSD45)                               { DIMENSION="f";}
        SCALAR(EPSD90)                               { DIMENSION="f";}
    }
    
    if( MAT_kin > 0.0)
    {
        SCALAR(MAT_CRA1)                              { DIMENSION="pressure"; }
        SCALAR(MAT_CRA2)                              { DIMENSION="pressure"; }
        SCALAR(MAT_CRA3)                              { DIMENSION="pressure"; }
        SCALAR(MAT_CRA4)                              { DIMENSION="pressure"; }
    }
    //*if( MAT_Iflag == 0 && MAT_NRATE > 0)
    //{
    //   DATA(FUN_LOAD);
    //ASSIGN(KEYWORD_STR, "          ");
    //  SCALAR(SCALE_LOAD);
    //  SCALAR(STRAINRATE_LOAD)					{ DIMENSION="strain_rate"; }

    //SIZE(MAT_NRATE);

    //  ARRAY(MAT_NRATE,"Strain rate") 
    //      {
    //mandatory:
    /*FUNCTION(FUN_LOAD) {
    X_TITLE     = "Plastic Strain"; Y_TITLE    = "Yield stress"; 
    X_DIMENSION = "DIMENSIONLESS"; Y_DIMENSION="pressure";
    // Y_SCALING(SCALE_LOAD);
    }
    */
    //DATA(FUN_LOAD);
    //optional:
    //SCALAR(STRAINRATE_LOAD) { DIMENSION="strain_rate"; }
    //SCALAR(SCALE_LOAD);


    //}
    // }*/


    /*mandatory:
    graphical SUPPORT("Support") {
    OBJECTS=(/PART/SHELL);
    ADD(PART,"Parts");
    }
    */

optional:
    graphical FLAG(Heat_Inp_opt);
    if (Heat_Inp_opt!= 0) {
        SUBOBJECT(SUBGRP_HEAT_MAT) {SUBTYPES = (/SUBOBJECT/HEAT);}  
    }
    graphical FLAG(THERM_STRESS);
    if (THERM_STRESS!= 0) {
        SUBOBJECT(SUBGRP_THERM_STRESS) {SUBTYPES = (/SUBOBJECT/THERM_STRESS);}  
    }
}

FORMAT(radioss140) 
{
    ASSIGN(IO_FLAG, 0, EXPORT);
    ASSIGN(IO_FLAG, 1,IMPORT);
    if(IO_FLAG == 1)
    {
        HEADER("/MAT/%3s",LAW_NO);
        if(LAW_NO == "BAR" )
        {
            ASSIGN(Mat_Name_OR_LawNo,1);
        }
        else
        {
            ASSIGN(Mat_Name_OR_LawNo,2);
        }
    }
    else if(IO_FLAG == 0 && Mat_Name_OR_LawNo == 1)
    {
        HEADER("/MAT/BARLAT2000/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    else
    {
        HEADER("/MAT/LAW87/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    CARD_PREREAD("                    %20s",DUMMY);
    if(DUMMY!="")
    {
        ASSIGN(MAT_REFRHO_Option,1,IMPORT);
    }
    else
    {
        ASSIGN(MAT_REFRHO_Option,0,IMPORT);
    }
    if(MAT_REFRHO_Option!=FALSE)
    {
        COMMENT("#              RHO_I               RHO_O");
        CARD("%20lg%20lg",MAT_RHO,Refer_Rho);
    }
    else{
        COMMENT("#              RHO_I");
        CARD("%20lg",MAT_RHO);
    }
    COMMENT("#                  E                  Nu     IFlag");
    CARD("%20lg%20lg%10d",MAT_E,MAT_NU,MAT_Iflag);
    COMMENT("#                 a1                  a2                  a3                  a4");
    CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA1,MAT_ALPHA2,MAT_ALPHA3,MAT_ALPHA4);
    COMMENT("#                 a5                  a6                  a7                  a8");
    CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA5,MAT_ALPHA6,MAT_ALPHA7,MAT_ALPHA8);
    COMMENT("# blank card");
    BLANK;
    if(MAT_Iflag == 0) {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth     Nrate");
        CARD("%20lg%20lg%20lg%20lg%10d%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH,MAT_NRATE);  

        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);

        if(MAT_NRATE > 0){
        COMMENT("#  Func_ID                        Yscale                Epsp");
        CELL_LIST(MAT_NRATE,"%10d          %20lg%20lg                                        ",FUN_LOAD,SCALE_LOAD,STRAINRATE_LOAD);  
        }
    } else {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth     Nrate");
        CARD("%20lg%20lg%20lg%20lg%10d%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH,MAT_NRATE);  

        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);
    }
    if(Heat_Inp_opt!=0)
    {
        SUBOBJECTS(SUBGRP_HEAT_MAT,/SUBOBJECT/HEAT);
    } 
    if(Heat_Inp_opt!=0 && THERM_STRESS !=0)
    {
        SUBOBJECTS(SUBGRP_THERM_STRESS,/SUBOBJECT/THERM_STRESS);
    }
}

FORMAT(radioss2017) {
    ASSIGN(IO_FLAG, 0, EXPORT);
    ASSIGN(IO_FLAG, 1,IMPORT);
    if(IO_FLAG == 1)
    {
        HEADER("/MAT/%3s",LAW_NO);
        if(LAW_NO == "BAR" )
        {
            ASSIGN(Mat_Name_OR_LawNo,1);
        }
    }
    else if(IO_FLAG == 0 && Mat_Name_OR_LawNo == 1)
    {
        HEADER("/MAT/BARLAT2000/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    else
    {
        HEADER("/MAT/LAW87/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    CARD_PREREAD("                    %20s",DUMMY);
    if(DUMMY!="")
    {
        ASSIGN(MAT_REFRHO_Option,1,IMPORT);
    }
    else
    {
        ASSIGN(MAT_REFRHO_Option,0,IMPORT);
    }
    if(MAT_REFRHO_Option!=FALSE)
    {
        COMMENT("#              RHO_I               RHO_O");
        CARD("%20lg%20lg",MAT_RHO,Refer_Rho);
    }
    else{
        COMMENT("#              RHO_I");
        CARD("%20lg",MAT_RHO);
    }
    COMMENT("#                  E                  Nu     IFlag        VP                   c                   P");
    CARD("%20lg%20lg%10d%10d%20lg%20lg",MAT_E,MAT_NU,MAT_Iflag,Vflag,STRAIN1,MAT_EXP1);
    COMMENT("#                 a1                  a2                  a3                  a4");
    CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA1,MAT_ALPHA2,MAT_ALPHA3,MAT_ALPHA4);
    COMMENT("#                 a5                  a6                  a7                  a8");
    CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA5,MAT_ALPHA6,MAT_ALPHA7,MAT_ALPHA8);
    COMMENT("# blank card");
    BLANK;
    if(MAT_Iflag == 0) {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth     Nrate");
        CARD("%20lg%20lg%20lg%20lg%10d%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH,MAT_NRATE);  

        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);

        if(MAT_NRATE > 0){
        COMMENT("#  Func_ID                        FSCALEi                Epsp");
        CELL_LIST(MAT_NRATE,"%10d          %20lg%20lg                                        ",FUN_LOAD,SCALE_LOAD,STRAINRATE_LOAD);  
        }
    } 
    else {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth     Nrate");
        CARD("%20lg%20lg%20lg%20lg%10d%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH,MAT_NRATE);  

        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);
    }
    if(Heat_Inp_opt!=0)
    {
        SUBOBJECTS(SUBGRP_HEAT_MAT,/SUBOBJECT/HEAT);
    } 
    if(Heat_Inp_opt!=0 && THERM_STRESS !=0)
    {
        SUBOBJECTS(SUBGRP_THERM_STRESS,/SUBOBJECT/THERM_STRESS);
    }
}

FORMAT(radioss2019) {
    ASSIGN(IO_FLAG, 0, EXPORT);
    ASSIGN(IO_FLAG, 1,IMPORT);
    if(IO_FLAG == 1)
    {
        HEADER("/MAT/%3s",LAW_NO);
        if(LAW_NO == "BAR" )
        {
            ASSIGN(Mat_Name_OR_LawNo,1);
        }
    }
    else if(IO_FLAG == 0 && Mat_Name_OR_LawNo == 1)
    {
        HEADER("/MAT/BARLAT2000/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    else
    {
        HEADER("/MAT/LAW87/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    CARD_PREREAD("                    %20s",DUMMY);
    if(DUMMY!="")
    {
        ASSIGN(MAT_REFRHO_Option,1,IMPORT);
    }
    else
    {
        ASSIGN(MAT_REFRHO_Option,0,IMPORT);
    }
    if(MAT_REFRHO_Option!=FALSE)
    {
        COMMENT("#              RHO_I               RHO_O");
        CARD("%20lg%20lg",MAT_RHO,Refer_Rho);
    }
    else{
        COMMENT("#              RHO_I");
        CARD("%20lg",MAT_RHO);
    }
    COMMENT("#                  E                  Nu     IFlag        VP                   c                   P");
    CARD("%20lg%20lg%10d%10d%20lg%20lg",MAT_E,MAT_NU,MAT_Iflag,Vflag,STRAIN1,MAT_EXP1);
    CARD_PREREAD("                                                                                %10d",Ifit);
    if(Ifit == 0)
    {
        COMMENT("#                 a1                  a2                  a3                  a4");
        CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA1,MAT_ALPHA2,MAT_ALPHA3,MAT_ALPHA4);

        COMMENT("#                 a5                  a6                  a7                  a8");
        CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA5,MAT_ALPHA6,MAT_ALPHA7,MAT_ALPHA8);
    }
    else if (Ifit == 1)
    {
        COMMENT("#           Sigma_00            Sigma_45            Sigma_90             Sigma_b     I_fit");
        CARD("%20lg%20lg%20lg%20lg%10d",Sigma_00,Sigma_45,Sigma_90,Sigma_b,Ifit);

        COMMENT("#               r_00                r_45                r_90                 r_b");
        CARD("%20lg%20lg%20lg%20lg",r_00,r_45,r_90,r_b);
    }
    COMMENT("# blank card");
    BLANK;
    if(MAT_Iflag == 0) {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth     Nrate");
        CARD("%20lg%20lg%20lg%20lg%10d%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH,MAT_NRATE);  
 
        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);

        if(MAT_NRATE > 0){
            COMMENT("#  Func_ID                        FSCALEi                Epsp");
            CELL_LIST(MAT_NRATE,"%10d          %20lg%20lg                                        ",FUN_LOAD,SCALE_LOAD,STRAINRATE_LOAD);  
        }
    } 
    else {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth     Nrate");
        CARD("%20lg%20lg%20lg%20lg%10d%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH,MAT_NRATE);  

        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);
    }
    if(Heat_Inp_opt!=0)
    {
        SUBOBJECTS(SUBGRP_HEAT_MAT,/SUBOBJECT/HEAT);
    } 
    if(Heat_Inp_opt!=0 && THERM_STRESS !=0)
    {
        SUBOBJECTS(SUBGRP_THERM_STRESS,/SUBOBJECT/THERM_STRESS);
    }
}



//
FORMAT(radioss2022) {
    ASSIGN(IO_FLAG, 0, EXPORT);
    ASSIGN(IO_FLAG, 1,IMPORT);
    if(IO_FLAG == 1)
    {
        HEADER("/MAT/%3s",LAW_NO);
        if(LAW_NO == "BAR" )
        {
            ASSIGN(Mat_Name_OR_LawNo,1);
        }
    }
    else if(IO_FLAG == 0 && Mat_Name_OR_LawNo == 1)
    {
        HEADER("/MAT/BARLAT2000/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    else
    {
        HEADER("/MAT/LAW87/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    CARD_PREREAD("                    %20s",DUMMY);
    if(DUMMY!="")
    {
        ASSIGN(MAT_REFRHO_Option,1,IMPORT);
    }
    else
    {
        ASSIGN(MAT_REFRHO_Option,0,IMPORT);
    }
    if(MAT_REFRHO_Option!=FALSE)
    {
        COMMENT("#              RHO_I               RHO_O");
        CARD("%20lg%20lg",MAT_RHO,Refer_Rho);
    }
    else{
        COMMENT("#              RHO_I");
        CARD("%20lg",MAT_RHO);
    }
    COMMENT("#                  E                  Nu     IFlag        VP                   c                   P");
    CARD("%20lg%20lg%10d%10d%20lg%20lg",MAT_E,MAT_NU,MAT_Iflag,Vflag,STRAIN1,MAT_EXP1);
    CARD_PREREAD("                                                                                %10d",Ifit);
    if(Ifit == 0)
    {
        COMMENT("#                 a1                  a2                  a3                  a4");
        CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA1,MAT_ALPHA2,MAT_ALPHA3,MAT_ALPHA4);

        COMMENT("#                 a5                  a6                  a7                  a8");
        CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA5,MAT_ALPHA6,MAT_ALPHA7,MAT_ALPHA8);
    }
    else if (Ifit == 1)
    {
        COMMENT("#           Sigma_00            Sigma_45            Sigma_90             Sigma_b     I_fit");
        CARD("%20lg%20lg%20lg%20lg%10d",Sigma_00,Sigma_45,Sigma_90,Sigma_b,Ifit);

        COMMENT("#               r_00                r_45                r_90                 r_b");
        CARD("%20lg%20lg%20lg%20lg",r_00,r_45,r_90,r_b);
    }
    COMMENT("#    Chard");
//           #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        CARD("%20lg",MAT_kin);  
    if(MAT_Iflag == 0) {
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#              exp_a                                                       F_cut  F_smooth     Nrate");
        CARD("%20lg%40s%20lg%10d%10d",A,_BLANK_,Fcut,MAT_FSMOOTH,MAT_NRATE);   
        COMMENT("# blank card");
        BLANK;
        if(MAT_NRATE > 0){
            COMMENT("#  Func_ID                        FSCALEi                Epsp");
            CELL_LIST(MAT_NRATE,"%10d          %20lg%20lg                                        ",FUN_LOAD,SCALE_LOAD,STRAINRATE_LOAD);  
        }
    } 
    else if(MAT_Iflag == 1)  {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth");
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        CARD("%20lg%20lg%20lg%20lg%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH);  
        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);
    }
    else if(MAT_Iflag == 2)  {
        COMMENT("#              exp_a");
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        CARD("%20lg",A );  
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#                 AM                  BM                  CM                  DM                  PM");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_AM, MAT_BM,MAT_CM,MAT_DM,MAT_PM);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#                 QM              E0MART                 VM0");  
        CARD("%20lg%20lg%20lg", MAT_QM,MAT_E0MART,MAT_VM0);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#                AHS                 BHS                 MHS                 NHS              EPS0HS");  
        CARD("%20lg%20lg%20lg%20lg%20lg", MAT_AHS,MAT_BHS,MAT_MHS,MAT_NHS,MAT_EPS0HS);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#              HMART                  K1                  K2");  
        CARD("%20lg%20lg%20lg",MAT_HMART,MAT_K1, MAT_K2);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#              TEMP0                TREF                  CP                 ETA");  
        CARD("%20lg%20lg%20lg%20lg", MAT_TEMP0 ,MAT_TREF ,MAT_CP,MAT_ETA);
    }
    if(MAT_kin > 0.0) {
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#               CRC1                CRA1                CRC2                CRA2");  
        CARD("%20lg%20lg%20lg%20lg", MAT_CRC1 ,MAT_CRA1 ,MAT_CRC2,MAT_CRA2);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#               CRC3                CRA3                CRC4                CRA4");  
        CARD("%20lg%20lg%20lg%20lg", MAT_CRC3 ,MAT_CRA3 ,MAT_CRC4,MAT_CRA4);
    }

    if(Heat_Inp_opt!=0)
    {
        SUBOBJECTS(SUBGRP_HEAT_MAT,/SUBOBJECT/HEAT);
    } 
    if(Heat_Inp_opt!=0 && THERM_STRESS !=0)
    {
        SUBOBJECTS(SUBGRP_THERM_STRESS,/SUBOBJECT/THERM_STRESS);
    }
}

//
FORMAT(radioss2025) {
    ASSIGN(IO_FLAG, 0, EXPORT);
    ASSIGN(IO_FLAG, 1,IMPORT);
    if(IO_FLAG == 1)
    {
        HEADER("/MAT/%3s",LAW_NO);
        if(LAW_NO == "BAR" )
        {
            ASSIGN(Mat_Name_OR_LawNo,1);
        }
    }
    else if(IO_FLAG == 0 && Mat_Name_OR_LawNo == 1)
    {
        HEADER("/MAT/BARLAT2000/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    else
    {
        HEADER("/MAT/LAW87/%d",_ID_);
        CARD("%-100s", TITLE);
    }
    CARD_PREREAD("                    %20s",DUMMY);
    if(DUMMY!="")
    {
        ASSIGN(MAT_REFRHO_Option,1,IMPORT);
    }
    else
    {
        ASSIGN(MAT_REFRHO_Option,0,IMPORT);
    }
    if(MAT_REFRHO_Option!=FALSE)
    {
        COMMENT("#              RHO_I               RHO_O");
        CARD("%20lg%20lg",MAT_RHO,Refer_Rho);
    }
    else{
        COMMENT("#              RHO_I");
        CARD("%20lg",MAT_RHO);
    }
    COMMENT("#                  E                  Nu     IFlag        VP                   c                   P");
    CARD("%20lg%20lg%10d%10d%20lg%20lg",MAT_E,MAT_NU,MAT_Iflag,Vflag,STRAIN1,MAT_EXP1);
    CARD_PREREAD("                                                                                %10d",Ifit);
    if(Ifit == 0)
    {
        COMMENT("#                 a1                  a2                  a3                  a4");
        CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA1,MAT_ALPHA2,MAT_ALPHA3,MAT_ALPHA4);

        COMMENT("#                 a5                  a6                  a7                  a8");
        CARD("%20lg%20lg%20lg%20lg",MAT_ALPHA5,MAT_ALPHA6,MAT_ALPHA7,MAT_ALPHA8);
    }
    else if (Ifit == 1)
    {
        COMMENT("#           Sigma_00            Sigma_45            Sigma_90             Sigma_b     I_fit");
        CARD("%20lg%20lg%20lg%20lg%10d",Sigma_00,Sigma_45,Sigma_90,Sigma_b,Ifit);

        COMMENT("#               r_00                r_45                r_90                 r_b");
        CARD("%20lg%20lg%20lg%20lg",r_00,r_45,r_90,r_b);
    }
    COMMENT("#    Chard");
//           #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        CARD("%20lg",MAT_kin);  
    if(MAT_Iflag == 0) {
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#              exp_a                                                       F_cut  F_smooth     Nrate");
        CARD("%20lg%40s%20lg%10d%10d",A,_BLANK_,Fcut,MAT_FSMOOTH,MAT_NRATE);   
        COMMENT("# blank card");
        BLANK;
        if(MAT_NRATE > 0){
            COMMENT("#  Func_ID                        FSCALEi                Epsp");
            CELL_LIST(MAT_NRATE,"%10d          %20lg%20lg                                        ",FUN_LOAD,SCALE_LOAD,STRAINRATE_LOAD);  
        }
    } 
    else if(MAT_Iflag == 1)  {
        COMMENT("#              exp_a               alpha                   n               F_cut  F_smooth");
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        CARD("%20lg%20lg%20lg%20lg%10d",A,MAT_VOL,FScale33,Fcut,MAT_FSMOOTH);  
        COMMENT("#             ASwift                Eps0               Qvoce                Beta                  KO");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_A,FScale22,MAT_PR,MAT_T0,MAT_NUt);
    }
    else if(MAT_Iflag == 2)  {
        COMMENT("#              exp_a");
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        CARD("%20lg",A );  
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#                 AM                  BM                  CM                  DM                  PM");  
        CARD("%20lg%20lg%20lg%20lg%20lg",MAT_AM, MAT_BM,MAT_CM,MAT_DM,MAT_PM);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#                 QM              E0MART                 VM0");  
        CARD("%20lg%20lg%20lg", MAT_QM,MAT_E0MART,MAT_VM0);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#                AHS                 BHS                 MHS                 NHS              EPS0HS");  
        CARD("%20lg%20lg%20lg%20lg%20lg", MAT_AHS,MAT_BHS,MAT_MHS,MAT_NHS,MAT_EPS0HS);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#              HMART                  K1                  K2");  
        CARD("%20lg%20lg%20lg",MAT_HMART,MAT_K1, MAT_K2);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#              TEMP0                TREF                  CP                 ETA");  
        CARD("%20lg%20lg%20lg%20lg", MAT_TEMP0 ,MAT_TREF ,MAT_CP,MAT_ETA);
    }
    else if(MAT_Iflag == 3)  {
//
        COMMENT("#              exp_a                                                       F_cut  F_smooth  I_smooth");
        CARD("%20lg%40s%20lg%10d%10d",A,_BLANK_,Fcut,MAT_FSMOOTH,MAT_ISMOOTH);  
        COMMENT("#            TAB_ID0             FSCALE0               EPSD0");
        CARD("%10s%10d%20lg%20lg",_BLANK_,TAB_ID0,FSCALE0,EPSD0);
        COMMENT("#           TAB_ID45            FSCALE45              EPSD45");
        CARD("%10s%10d%20lg%20lg",_BLANK_,TAB_ID45,FSCALE45,EPSD45);
        COMMENT("#           TAB_ID90            FSCALE90              EPSD90");
        CARD("%10s%10d%20lg%20lg",_BLANK_,TAB_ID90,FSCALE90,EPSD90);
//
    }
    if(MAT_kin > 0.0) {
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#               CRC1                CRA1                CRC2                CRA2");  
        CARD("%20lg%20lg%20lg%20lg", MAT_CRC1 ,MAT_CRA1 ,MAT_CRC2,MAT_CRA2);
//               #---1----|----2----|----3----|----4----|----5----|----6----|----7----|----8----|----9----|---10----|
        COMMENT("#               CRC3                CRA3                CRC4                CRA4");  
        CARD("%20lg%20lg%20lg%20lg", MAT_CRC3 ,MAT_CRA3 ,MAT_CRC4,MAT_CRA4);
    }

    if(Heat_Inp_opt!=0)
    {
        SUBOBJECTS(SUBGRP_HEAT_MAT,/SUBOBJECT/HEAT);
    } 
    if(Heat_Inp_opt!=0 && THERM_STRESS !=0)
    {
        SUBOBJECTS(SUBGRP_THERM_STRESS,/SUBOBJECT/THERM_STRESS);
    }
}
